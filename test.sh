#!/bin/bash
go build elasticsearch_client.go

./elasticsearch_client "{\"Records\":[{\"EventSource\":\"aws:sns\",\"EventVersion\":\"1.0\",\"EventSubscriptionArn\":\"arn:aws:sns:us-east-1:406396564037:AutoScalingAlarmTopic:e41c00b9-2088-4f59-b7c6-1d5c9899ad99\",\"Sns\":{\"Type\":\"Notification\",\"MessageId\":\"023f04c4-18ee-5f0f-80d9-54445b4a7a89\",\"TopicArn\":\"arn:aws:sns:us-east-1:406396564037:AutoScalingAlarmTopic\",\"Subject\":\"Auto Scaling: termination for group \\\"awseb-e-if3nue7isk-stack-AWSEBAutoScalingGroup-6X286MUVVDQ7\\\"\",\"Message\":\"{\\\"Progress\\\":50,\\\"AccountId\\\":\\\"406396564037\\\",\\\"Description\\\":\\\"Terminating EC2 instance: i-42e8d854\\\",\\\"RequestId\\\":\\\"bc777990-011c-40b9-8756-528d76b4dcd8\\\",\\\"EndTime\\\":\\\"2016-10-18T15:36:04.496Z\\\",\\\"AutoScalingGroupARN\\\":\\\"arn:aws:autoscaling:us-east-1:406396564037:autoScalingGroup:3b4ae7d6-f4bc-4733-b948-1701bd808191:autoScalingGroupName/awseb-e-if3nue7isk-stack-AWSEBAutoScalingGroup-6X286MUVVDQ7\\\",\\\"ActivityId\\\":\\\"bc777990-011c-40b9-8756-528d76b4dcd8\\\",\\\"StartTime\\\":\\\"2016-10-18T15:35:14.008Z\\\",\\\"Service\\\":\\\"AWS Auto Scaling\\\",\\\"Time\\\":\\\"2016-10-18T15:36:04.496Z\\\",\\\"EC2InstanceId\\\":\\\"i-42e8d854\\\",\\\"StatusCode\\\":\\\"InProgress\\\",\\\"StatusMessage\\\":\\\"\\\",\\\"Details\\\":{\\\"Availability Zone\\\":\\\"us-east-1c\\\",\\\"InvokingAlarms\\\":[{\\\"Trigger\\\":{\\\"MetricName\\\":\\\"CPUUtilization\\\",\\\"ComparisonOperator\\\":\\\"LessThanThreshold\\\",\\\"Statistic\\\":\\\"AVERAGE\\\",\\\"Dimensions\\\":[{\\\"name\\\":\\\"AutoScalingGroupName\\\",\\\"value\\\":\\\"awseb-e-if3nue7isk-stack-AWSEBAutoScalingGroup-6X286MUVVDQ7\\\"}],\\\"Period\\\":300,\\\"EvaluationPeriods\\\":1,\\\"Unit\\\":\\\"Percent\\\",\\\"Namespace\\\":\\\"AWS/EC2\\\",\\\"Threshold\\\":20},\\\"AlarmName\\\":\\\"awseb-e-if3nue7isk-stack-AWSEBCloudwatchAlarmLow-8MBNCAAU7KWK\\\",\\\"AlarmDescription\\\":\\\"ElasticBeanstalk Default Scale Down alarm\\\",\\\"AWSAccountId\\\":\\\"406396564037\\\",\\\"OldStateValue\\\":\\\"ALARM\\\",\\\"NewStateReason\\\":\\\"Threshold Crossed: 1 datapoint (5.565294117647059) was less than the threshold (20.0).\\\",\\\"Region\\\":\\\"US East - N. Virginia\\\",\\\"NewStateValue\\\":\\\"ALARM\\\",\\\"StateChangeTime\\\":1476200160657}]},\\\"AutoScalingGroupName\\\":\\\"awseb-e-if3nue7isk-stack-AWSEBAutoScalingGroup-6X286MUVVDQ7\\\",\\\"Cause\\\":\\\"At 2016-10-18T15:35:00Z a monitor alarm awseb-e-if3nue7isk-stack-AWSEBCloudwatchAlarmLow-8MBNCAAU7KWK in state ALARM triggered policy awseb-e-if3nue7isk-stack-AWSEBAutoScalingScaleDownPolicy-1GHVDORSTNSUN changing the desired capacity from 4 to 3.  At 2016-10-18T15:35:13Z an instance was taken out of service in response to a difference between desired and actual capacity, shrinking the capacity from 4 to 3.  At 2016-10-18T15:35:14Z instance i-42e8d854 was selected for termination.\\\",\\\"Event\\\":\\\"autoscaling:EC2_INSTANCE_TERMINATE\\\"}\",\"Timestamp\":\"2016-10-18T15:36:04.559Z\",\"SignatureVersion\":\"1\",\"Signature\":\"cDZIHZa9hts/0+TEaW2BBvOhKSj4Du9UBV0iVC0ZdB/dLSvcZ5K5ufqgMqb4D5x6TQcT02T3ziM72m54BztpLX216ECKYKDUahyp5g+ehMmrRPO5AfsrzkrmAt96Mgz7FDaRg4vjrbG/AgG5nHUzxy4GPhnArc6hZoZfTM6jNq6fY7CS6gC9w2P/ZIJlA9gG9AXUWvbihawALWlHiqVgG3hYCPVppnd/rvh2jiFOoP3E8550KurHQwwyFEpPyt/Ep6NC5esybEDQ8jqa1K1hw9ut3dMxjRgoql7HE4yZm1DACkC/KRFUtWGWnALJa0TZRqNDb8PmR7q8GWDaRk87NA==\",\"SigningCertUrl\":\"https://sns.us-east-1.amazonaws.com/SimpleNotificationService-b95095beb82e8f6a046b3aafc7f4149a.pem\",\"UnsubscribeUrl\":\"https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:406396564037:AutoScalingAlarmTopic:e41c00b9-2088-4f59-b7c6-1d5c9899ad99\",\"MessageAttributes\":{}}}]}"
